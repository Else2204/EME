# Weekly Analysis 

This script provides means to generate weekly reports that measure the performance of the energy management system. 


## Python modules needed

Most of the modules were already needed when running SEMET or are used in the evaluation script eme.ipynb. To these, use "import <module>" (if working in a notebook) and add:
 * glob
 * locale
 * csv
 
 The glob module will be used to iterate over files. Set `locale.setlocale(locale.LC_ALL, '')` in the beginning for parsing in case of double values in EXAA prices (e.g. daylight saving time changes). See espp line 45. 
 
 
 ## Preparations
 
 Configurating the energy system, creating the object to load, store and process data from the real energy system are the same as in the evaluation script eme.ipynb. 
 
 
 ## Select the data corresponding to an active Research Mode
 
 The last column in the original data represents the status of the Research Mode, which can be either active (1.0) or inactive (0.0). The function `retrieve_data` reads each file and creates a new `.csv` containing the rows for which the last column is equal to 1.0. 
 Notes regarding the content of the function:
 * `'\data.orig\\'` is a subdirectory of `.getcwd()`
 * one has to `read_csv`, not the DataFrame, since one is still working with a filepath
 * one has to fill the NaN values, since in the initial structure of the original data all NaN values under a 1.0 are equal to 1.0 until a 0.0 appears (and vice-versa)
 * in the following, one will need to work with the newly created .csv files as they are generated by the function. Deleting columns or any kind of editing will damage the content of the file. Use Notepad instead of Microsoft Excel to check the content of the data and if it corresponds to the original data.
 
 
 ## Check validity of data based on separator
 
 The delimiter used in the script is ";". Although the previous function should separate the content correctly, this function is meant to check it for individual files.
 
 
 ## Iterate over files to create weekly report
 
 Although the newly created files should keep the right encoding, it is checked whether the files have `cp1252` encoding as the file processing begins (in which case an error is thrown). Afterwards, the start/end date and time are extracted based on the name of the file (string). 
 
 The function is similar to the daily analysis one presented in eme.ipynb, noting that the Timedelta is seven days in this case. A report is created in the end.
 Notes:
  * Open the report with LibreOffice
  * The analysis of the data that has been done so far works, but the results might not be realistic. This might be due to some parameters whose positive/negative value might have been interchanged throughout the time. 
